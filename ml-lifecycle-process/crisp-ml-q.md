---
description: >-
  Cross-Industry Standard Process for the development of Machine Learning
  applications with Quality assurance methodology (CRISP-ML(Q))
---

# CRISP-ML(Q)

<figure><img src="../.gitbook/assets/image (1) (1).png" alt=""><figcaption><p>Machine Learning Development Life Cycle Process.</p></figcaption></figure>

В цілому процес CRISP-ML(Q) можна поділити на шість етапів:

1. Розуміння постановки бізнес завдання та даних (Business and Data Understanding)
2. Підготовка даних(Data Engineering / Data Preparation)
3. Моделювання (Machine Learning Model Engineering)
4. Тестування (Quality Assurance for Machine Learning Applications)
5. Дослідно-промислова експлуатація (Deployment)
6. Моніторинг та технічна підтримка (Monitoring and Maintenance).

Для кожної фази моделі процесу підхід до забезпечення якості в CRISP-ML(Q) вимагає визначення вимог і обмежень (наприклад продуктивність, вимоги до якості даних, стійкість моделі тощо), визначення конкретних завдань (наприклад, вибір алгоритму ML, навчання моделі тощо), специфікація ризиків, які можуть негативно вплинути на ефективність та успіх ML моделі (наприклад зміщення, перенавчання, складно відтворити результати), методи забезпечення якості для зменшення ризиків (наприклад, перехресна перевірка, документування процесів та результатів тощо).

<figure><img src="../.gitbook/assets/image (9).png" alt=""><figcaption><p><a href="https://arxiv.org/pdf/2003.05155.pdf">CRISP-ML(Q)</a> підхід для забезпечення якості на кожному із шести етапів </p></figcaption></figure>

### Розуміння потреб бізнесу та даних (Business and Data Understanding) <a href="#business-and-data-understanding" id="business-and-data-understanding"></a>

Розробка програмних застосунків машинного навчання починається з визначення обсягу ML-застосунку, критеріїв успіху та перевірки якості даних. Метою першої фази є забезпечення можливості реалізації проекту.

У цій фазі ми збираємо критерії успіху разом з бізнес-критеріями, критеріями успішності машинного навчання та економічними критеріями. Ці критерії повинні бути вимірюваними. Тому важливо визначити чіткі та вимірювані ключові показники ефективності (KPI), такі як "економія часу на користувача і сесію". Корисним підходом є визначення не-ML евристичної оцінки, щоб передати вплив завдань машинного навчання зацікавленим сторонам бізнесу.

Підтвердження можливості перед налаштуванням проекту з машинним навчанням є найкращою практикою в промисловому середовищі. Використання фреймворку ML Canvas є структурованим способом виконання цього завдання. ML Canvas надає керівництво по фазам передбачення та навчання ML-застосунку. Крім того, він дозволяє всім зацікавленим сторонам вказати доступність даних, регулятивні обмеження та вимоги до застосунку, такі як надійність, масштабованість, пояснюваність та вимоги до ресурсів.

Оскільки дані керують процесом, збір даних та перевірка якості даних є важливими для досягнення бізнес-цілей. Тому одним з ключових вимог є документування статистичних властивостей даних та процесу їх генерації. Аналогічно, вимоги до даних повинні бути визначені й задокументовані, оскільки вони становлять основу для забезпечення якості даних під час експлуатаційної фази проекту з машинним навчанням.

### Підготовка даних (Data Engineering \\( Data Preparation) <a href="#data-engineering-data-preparation" id="data-engineering-data-preparation"></a>

Друга фаза моделі CRISP-ML(Q) спрямована на підготовку даних для наступної фази моделювання. У цій фазі виконуються завдання відбору даних, очищення даних, інженерії ознак та стандартизації даних.

Ми визначаємо цінні та необхідні ознаки для майбутнього тренування моделі за допомогою фільтруючих методів, методів упаковки або вбудованих методів для відбору даних. Крім того, ми відбираємо дані, відкидаючи вибірки, які не відповідають вимогам до якості даних. Також, на цьому етапі ми можемо вирішувати проблему незбалансованих класів шляхом застосування стратегій перевибірки або недостатньої вибірки.

Завдання очищення даних передбачає виявлення та виправлення помилок у наявних даних. Додавання модульних тестів для даних допоможе зменшити ризик поширення помилок на наступну фазу. Залежно від задачі машинного навчання, ми можемо проводити інженерію ознак та розширення даних. Наприклад, такі методи включають one-hot кодування, кластеризацію або дискретизацію неперервних атрибутів.

Завдання стандартизації даних означає процес уніфікації вхідних даних інструментів машинного навчання для уникнення ризику помилкових даних. Нарешті, завдання нормалізації даних допоможе зменшити ризик упередженості до ознак на більшій шкалі. Ми будуємо конвейери перетворення даних та вхідних даних для попередньої обробки даних та створення ознак, щоб забезпечити відтворюваність ML-додатка під час цієї фази.

### Моделювання (Machine Learning Model Engineering)

Фаза моделювання є специфічною для машинного навчання частиною процесу. Ця фаза спрямована на визначення однієї або кількох моделей машинного навчання, які будуть впроваджені в продукцію. Переклад до машинного навчання залежить від бізнес-проблеми, яку ми намагаємося вирішити. Обмеження та вимоги з фази Розуміння бізнесу та даних визначатимуть цю фазу. Наприклад, метрики оцінки моделі в області застосування можуть включати метрики продуктивності, стійкості, справедливості, масштабованості, інтерпретованості, ступеня складності моделі та вимог до ресурсів моделі. Ми повинні налаштувати важливість кожної з цих метрик залежно від використання.

Загалом, фаза моделювання включає вибір моделі, спеціалізацію моделі та навчання моделі. Додатково, залежно від застосування, ми можемо використовувати попередньо навчену модель, стиснути модель або застосовувати методи ансамблю для отримання кінцевої моделі машинного навчання.

Одна з основних скарг на проекти з машинного навчання - це відсутність відтворюваності. Тому ми повинні забезпечити відтворюваність методу та результатів фази моделювання, збираючи метадані процесу навчання моделі. Зазвичай ми збираємо такі метадані: алгоритм, навчальний, перевірочний та тестовий набори даних, гіперпараметри та опис середовища виконання. Відтворюваність результатів передбачає перевірку середньої продуктивності моделі за допомогою різних початкових умов. Дотримуючись найкращих практик, документування навчених моделей підвищує прозорість та пояснюваність в проектах з машинним навчанням. Корисним інструментом в цьому випадку є "Model Cards Toolkit".

Багато фаз у розробці машинного навчання є ітеративними. Іноді нам може знадобитись перегляд бізнес-цілей, KPI та доступних даних з попередніх кроків, щоб відрегулювати результати моделі машинного навчання.

Нарешті, ми упаковуємо робочий процес машинного навчання в потік, щоб створити повторюваний процес навчання моделі під час фази моделювання.

### Оцінювання моделей (Evaluating Machine Learning Models) <a href="#evaluating-machine-learning-models" id="evaluating-machine-learning-models"></a>

Отже, навчання моделі супроводжується етапом оцінювання моделі, також відомим як офлайн-тестування. Під час цього етапу продуктивність навченої моделі потрібно перевірити на тестовому наборі даних. Крім того, надійність моделі слід оцінювати за допомогою шумних або неправильних вхідних даних. Також гарною практикою є розробка зрозумілої (explainable) моделі ML, щоб забезпечити довіру, відповідати нормативним вимогам і керувати людьми у прийнятті рішень за допомогою ML.

Нарешті, рішення про розгортання моделі має прийматися автоматично на основі критеріїв успіху або вручну експертами домену та ML. Подібно до етапу моделювання, усі результати даного етапу оцінювання необхідно документувати.

### Розгортання моделі (Deployment) <a href="#deployment" id="deployment"></a>

Розгортання моделі ML означає процес інтеграції моделі ML в існуючу програмну систему. Після успішного проходження етапу оцінки в життєвому циклі розробки ML модель випускається для розгортання в (перед) виробничому середовищі (test env). Підходи до розгортання визначаються на першому етапі життєвого циклу розробки ML. Вони відрізнятимуться залежно від сценарію використання та режиму навчання та прогнозування, пакетного (batch) або онлайнового. Наприклад, розгортання моделі ML означає надання її прогностичної функціональності у вигляді інтерактивних інформаційних панелей і попередньо обчислених прогнозів, упаковку моделі ML як плагіна в архітектурі програмного забезпечення [мікроядра ](https://www.oreilly.com/library/view/software-architecture-patterns/9781491971437/ch03.html)або кінцевої точки веб-сервісу в розподіленій системі.

Розгортання моделі ML включає вирішення таких завдань: визначення апаратного забезпечення, оцінка моделі у виробничому середовищі (онлайн-тестування, наприклад, A/B-тестування), тестування зручності використання, забезпечення резервного плану для збоїв моделі та налаштування стратегію розгортання, щоб поступово розгортати нову модель (наприклад, розгортання canary або green/blue).

### Моніторинг та технічна підтримка (Monitoring and Maintenance) <a href="#monitoring-and-maintenance" id="monitoring-and-maintenance"></a>

Коли модель ML запущено, важливо стежити за її продуктивністю та підтримувати її. Коли модель ML працює на реальних даних, основним ризиком є ефект «застарівання моделі», коли продуктивність моделі падає з часом, коли вона починає працювати з даними, які не були присутні у тренувальному наборі. Крім того, на продуктивність моделі впливає продуктивність апаратного забезпечення та наявний стек програмного забезпечення. Таким чином, найкращим способом запобігання падінню продуктивності моделі є виконання завдання моніторингу, коли продуктивність моделі постійно оцінюється, щоб вирішити, чи потрібно модель перенавчати. Цей процес відомий як шаблон неперервної оцінки моделі ([Continued Model Evaluation pattern](https://www.oreilly.com/library/view/machine-learning-design/9781098115777/)). Висновки із моніторингу призводить до оновлення моделі ML. Окрім моніторингу за перенавчанням моделі великий вплив має також бізнес-бачення та зміна стратегічних завдань.

### Висновок <a href="#conclusion" id="conclusion"></a>

Розгортання моделей передбачає багато взаємодіючих компонентів і процесів. У цій статті було розглянуто модель життєвого циклу розробки CRISP-ML(Q). Загалом, CRISP-ML(Q) — це систематична модель процесу для розробки програмного забезпечення для машинного навчання, яка створює усвідомлення можливих ризиків і наголошує на забезпеченні якості, щоб зменшити ці ризики для забезпечення успіху проекту ML. У наведеній нижче таблиці підсумовано основні етапи CRISP-ML(Q) і відповідні завдання:

| CRISP-ML(Q) етапи:                 | Завдання які вирішуються                                                                                                                                                                                                                                                                                                                                                                                                        |
| ---------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Розуміння бізнес процесів та даних | <ul><li> Визначення бізнес цілей та завдань</li><li>Трансформація бізнес вимог у технічне завдання</li><li>Збір та верифікація даних</li><li>Оцінка реалізації проекту</li><li>Перевірка концепції (ProofOfConcept)</li></ul>                                                                                                                                                                                                   |
| Підготовка даних                   | <ul><li>Вибір факторів</li><li>Вибір джерел даних</li><li>Збалансування класів</li><li>Очистка даних (зменшення шуму, заповнення пропусків)</li><li>Генерація нових факторів</li><li>Збагачення даних</li><li>Стандартизація та нормалізація даних</li></ul>                                                                                                                                                                    |
| Моделювання                        | <ul><li>Визначення метрик оцінки якості моделі</li><li>Вибір ML алгоритмів (baseline)</li><li>Тюніг моделі із застосуванням предметної області </li><li>Навчання моделі</li><li>Опціонально: застосування trainsfer - learning (з використанням попередньо підготовлених моделей)</li><li>Стискання моделей</li><li>Створення ансамблів моделей</li><li>Документування моделей та результатів експериментів</li></ul>           |
| Оцінка результатів                 | <ul><li> Оцінка точності моделей</li><li> Визначення надійності </li><li>Покращення пояснювальності  (explainability) моделі</li><li>Прийняття рішення  про розгортання</li><li>Документування результатів</li></ul>                                                                                                                                                                                                            |
| Розгортання моделі                 | <ul><li>Оцінка розгорнутої моделі</li><li>Забезпечте прийняття користувачами та зручність використання</li><li>Визначення порядку управління</li><li>Розгортання відповідно до обраної стратегії (A/B тестування, багаторукі бандити (multi-armed bandits)</li></ul>                                                                                                                                                            |
| Моніторинг та технічна підтримка   | <ul><li>Відстеження ефективності і дієвості прогнозів моделі</li><li>Порівняння з попередньо визначеними критеріями успіху (порогові значення)</li><li>Перенавчання моделі, якщо потрібно</li><li>Збереження нових даних</li><li>Виконання розмітки нових даних</li><li>Повторіть завдання з етапів <em>Розробка моделі</em> та <em>Оцінка моделі</em></li><li>Безперервна інтеграція, навчання та розгортання моделі</li></ul> |
